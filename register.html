<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover"/>
<title>Cadastro - ontercept</title>
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
--bg-0:#eef2ff;
--bg-1:#f8fafc;
--surface:#ffffff;
--muted:#6b7280;
--muted-2:#54585f;
--primary:#2463f0;
--primary-600:#1f56d6;
--accent:#7c3aed;
--success:#10b981;
--danger:#ef4444;
--warning:#f59e0b;
--glass:rgba(255,255,255,0.6);
--radius-xs:6px;
--radius-sm:8px;
--radius-md:12px;
--radius-lg:16px;
--radius-xl:20px;
--shadow-sm:0 4px 8px rgba(16,24,40,0.04);
--shadow-md:0 10px 24px rgba(16,24,40,0.06);
--shadow-lg:0 16px 48px rgba(16,24,40,0.12);
--shadow-primary:0 10px 32px rgba(36,99,240,0.2);
--gap-1:6px;
--gap-2:10px;
--gap-3:14px;
--gap-4:20px;
--gap-5:26px;
--gap-6:32px;
--transition:all .2s cubic-bezier(.4,0,.2,1);
--header-top-offset:16px;
--header-height:72px;
}
html{
font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
font-size:15px;
line-height:1.5;
-webkit-font-smoothing:antialiased;
-moz-osx-font-smoothing:grayscale;
scroll-behavior:smooth;
color-scheme:light
}
*{
box-sizing:border-box;
margin:0;
padding:0
}
body{
margin:0;
min-height:100vh;
background:radial-gradient(1200px 600px at 10% 0%,rgba(36,99,240,.08),transparent 60%),radial-gradient(1000px 600px at 90% 90%,rgba(124,58,237,.08),transparent 60%),linear-gradient(160deg,var(--bg-0) 0%,var(--bg-1) 100%);
color:#0b1220;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
padding: calc(var(--header-top-offset) + var(--header-height) + 24px) 16px 20px;
position:relative;
overflow-x:hidden
}
header.app-header{
position:fixed;
top:var(--header-top-offset);
left:50%;
transform:translateX(-50%);
width:calc(100% - 32px);
max-width:560px;
min-height:var(--header-height);
background:linear-gradient(180deg,rgba(255,255,255,0.75),rgba(255,255,255,0.55));
backdrop-filter:blur(14px);
-webkit-backdrop-filter:blur(14px);
border-radius:var(--radius-xl);
padding:12px 20px;
display:flex;
align-items:center;
justify-content:center;
box-shadow:var(--shadow-md);
border:1px solid rgba(255,255,255,0.6);
z-index:1200
}
.logo{
display:flex;
align-items:center;
gap:10px;
font-weight:800;
font-size:18px;
color:#0f172a;
letter-spacing:-.2px
}
.logo-image{
height:46px;
width:auto;
border-radius:0;
object-fit:contain;
display:block;
box-shadow:none;
background:transparent;
transition:var(--transition)
}
.logo:hover .logo-image{
transform:rotate(6deg) scale(1.02)
}
main.register-container{
width:100%;
max-width:560px;
background:linear-gradient(180deg,rgba(255,255,255,0.85),rgba(251,253,255,0.78));
backdrop-filter:blur(14px);
-webkit-backdrop-filter:blur(14px);
border-radius:24px;
padding:30px;
box-shadow:var(--shadow-lg);
border:1px solid rgba(255,255,255,0.7);
transition:none;
position:relative;
overflow:hidden;
margin:0 auto
}
main.register-container::before{
content:"";
position:absolute;
inset:0;
pointer-events:none;
background:conic-gradient(from 210deg at 10% 10%,rgba(36,99,240,.04),transparent 20%),conic-gradient(from 10deg at 90% 90%,rgba(124,58,237,.04),transparent 25%)
}
.panel-header{
display:flex;
align-items:center;
gap:12px;
margin-bottom:20px;
padding-bottom:16px;
border-bottom:1px solid rgba(15,23,42,0.06);
justify-content:center
}
.panel-header h1{
font-size:24px;
margin:0;
color:#0b1220;
font-weight:800;
letter-spacing:-.3px
}
.panel-sub{
text-align:center;
color:var(--muted);
font-weight:500;
margin-top:6px;
margin-bottom:6px;
font-size:14px
}
.form-grid{
display:grid;
grid-template-columns:1fr;
gap:var(--gap-4)
}
.field{
display:flex;
flex-direction:column;
gap:8px
}
.input-label{
display:flex;
align-items:center;
gap:6px;
font-weight:600;
color:var(--muted-2);
font-size:13px
}
.input-wrapper{
position:relative;
display:flex;
align-items:center
}
.input{
appearance:none;
width:100%;
padding:14px 42px 14px 14px;
border-radius:14px;
border:1px solid rgba(15,23,42,0.08);
background:rgba(251,253,255,0.9);
font-size:15px;
color:#0b1220;
box-shadow:inset 0 1px 3px rgba(2,6,23,0.02)
}
.input::placeholder{
color:#9aa0a6;
font-size:14px
}
.input:hover{
border-color:rgba(15,23,42,0.14)
}
.input:focus{
outline:none;
box-shadow:0 0 0 3px rgba(36,99,240,0.12),0 10px 22px rgba(36,99,240,0.1);
border-color:var(--primary);
background:#fff
}
.input.input-error{
border-color:var(--danger)
}
.input.input-error:focus{
box-shadow:0 0 0 3px rgba(239,68,68,0.12),0 10px 22px rgba(239,68,68,0.1)
}
.toggle-password{
position:absolute;
right:6px;
top:50%;
transform:translateY(-50%);
background:transparent;
border:none;
color:var(--muted);
cursor:pointer;
padding:8px;
border-radius:10px;
display:inline-flex;
align-items:center;
justify-content:center
}
.toggle-password:hover,.toggle-password:focus-visible{
color:var(--primary);
background:rgba(36,99,240,0.08);
outline:none
}
.assist{
display:flex;
align-items:center;
gap:6px;
font-size:12px;
color:var(--muted)
}
.error-message{
display:flex;
align-items:center;
gap:6px;
color:var(--danger);
font-size:12px;
font-weight:600;
min-height:16px
}
.password-strength{
margin-top:6px;
height:6px;
background:rgba(15,23,42,0.08);
border-radius:3px;
overflow:hidden
}
.password-strength-meter{
height:100%;
width:0%;
transition:var(--transition)
}
.password-strength-meter.weak{
background:var(--danger);
width:33%
}
.password-strength-meter.medium{
background:var(--warning);
width:66%
}
.password-strength-meter.strong{
background:var(--success);
width:100%
}
.password-hints{
margin-top:6px;
display:flex;
flex-direction:column;
gap:4px
}
.password-hint{
display:flex;
align-items:center;
gap:6px;
font-size:12px
}
.password-hint.valid{
color:var(--success);
font-weight:600
}
.password-hint.invalid{
color:var(--muted)
}
.terms{
display:flex;
align-items:flex-start;
gap:10px;
margin:2px 0 0
}
.terms input{
margin-top:2px
}
.terms label{
font-size:13px;
color:var(--muted-2);
line-height:1.5
}
.terms a{
color:var(--primary);
font-weight:600;
text-decoration:underline;
text-underline-offset:2px
}
.action-area{
margin-top:6px;
display:flex;
flex-direction:column;
gap:10px
}
.action-button{
width:100%;
padding:16px;
border-radius:16px;
border:none;
background:linear-gradient(90deg,var(--primary),var(--primary-600));
color:#fff;
font-weight:700;
font-size:15px;
letter-spacing:.1px;
display:inline-flex;
align-items:center;
justify-content:center;
gap:10px;
cursor:pointer;
box-shadow:var(--shadow-primary);
position:relative;
overflow:hidden
}
.action-button::after{
content:"";
position:absolute;
inset:0;
background:linear-gradient(90deg,transparent,rgba(255,255,255,.35),transparent);
transform:translateX(-100%)
}
.action-button:hover:not(:disabled){
transform:none;
box-shadow:0 16px 40px rgba(36,99,240,.24)
}
.action-button:disabled{
opacity:.6;
cursor:not-allowed;
transform:none;
box-shadow:none
}
.login-link{
text-align:center;
color:var(--muted);
font-size:14px
}
.login-link a{
color:var(--primary);
font-weight:600;
text-decoration:underline;
text-underline-offset:2px
}
.notification{
position:fixed;
right:24px;
top:24px;
background:rgba(255,255,255,0.96);
backdrop-filter:blur(14px);
-webkit-backdrop-filter:blur(14px);
padding:16px 20px;
border-radius:14px;
box-shadow:var(--shadow-lg);
display:flex;
align-items:center;
gap:12px;
border-left:4px solid var(--success);
transform:translateX(120%);
opacity:0;
transition:all .3s cubic-bezier(.2,.9,.2,1);
z-index:1300;
border:1px solid rgba(255,255,255,0.7)
}
.notification.show{
transform:translateX(0);
opacity:1
}
.notification.error{
border-left-color:var(--danger)
}
.notification-icon{
width:22px;
height:22px;
color:var(--success)
}
.notification.error .notification-icon{
color:var(--danger)
}
.notification-content{
color:var(--muted-2);
font-weight:600;
font-size:14px
}
@media (max-width:768px){
body{padding: calc(var(--header-top-offset) + var(--header-height) + 12px) 12px 16px}
main.register-container{padding:24px;border-radius:20px}
.panel-header h1{font-size:21px}
header.app-header{left:50%;transform:translateX(-50%);width:calc(100% - 24px);max-width:520px}
}
@media (prefers-reduced-motion:reduce){
*{transition:none!important;animation:none!important}
}
:where(button,a,input,[type="checkbox"]):focus-visible{
outline:2px solid rgba(36,99,240,.6);
outline-offset:1px
}
input:-webkit-autofill{
box-shadow:0 0 0 40px #fff inset;
border-radius:14px
}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
</style>
</head>
<body>
<header class="app-header" role="banner">
<div class="logo">
<img src="{{ url_for('static', filename='logo.png') }}" alt="ontercept" class="logo-image">
</div>
</header>
<main class="register-container" role="main" aria-labelledby="title">
<div class="panel-header" id="title">
<svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
<circle cx="8.5" cy="7" r="4"/>
<line x1="20" y1="8" x2="20" y2="14"/>
<line x1="23" y1="11" x2="17" y2="11"/>
</svg>
<h1>Criar Conta</h1>
</div>
<p class="panel-sub">Crie sua conta para acessar o painel com segurança e rapidez.</p>
<form id="registerForm" action="/register" method="post" novalidate>
<div class="form-grid">
<div class="field">
<label for="username" class="input-label">Nome de usuário</label>
<div class="input-wrapper">
<input type="text" id="username" name="username" class="input" autocomplete="username" placeholder="seunome" required aria-required="true" aria-describedby="username-err"/>
</div>
<p id="username-err" class="error-message" role="alert" aria-live="polite"></p>
</div>
<div class="field">
<label for="email" class="input-label">E-mail</label>
<div class="input-wrapper">
<input type="email" id="email" name="email" class="input" autocomplete="email" placeholder="seu@email.com" required aria-required="true" aria-describedby="email-err"/>
</div>
<p id="email-err" class="error-message" role="alert" aria-live="polite"></p>
</div>
<div class="field">
<label for="password" class="input-label">Senha segura</label>
<div class="input-wrapper">
<input type="password" id="password" name="password" class="input" autocomplete="new-password" placeholder="••••••••" required aria-required="true" aria-describedby="password-hints password-err" aria-controls="passwordStrength"/>
<button type="button" class="toggle-password" id="togglePassword" aria-label="Mostrar senha" aria-pressed="false">
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
<circle cx="12" cy="12" r="3"/>
</svg>
</button>
</div>
<div class="password-strength" aria-hidden="false">
<div class="password-strength-meter" id="passwordStrength"></div>
</div>
<div id="passwordA11y" role="status" aria-live="polite" class="sr-only"></div>
<div class="password-hints" id="password-hints">
<div class="password-hint invalid" id="lengthHint">
<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2" aria-hidden="true">
<circle cx="12" cy="12" r="10"/>
<line x1="15" y1="9" x2="9" y2="15"/>
<line x1="9" y1="9" x2="15" y2="15"/>
</svg>
Mínimo de 8 caracteres
</div>
<div class="password-hint invalid" id="uppercaseHint">
<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2" aria-hidden="true">
<circle cx="12" cy="12" r="10"/>
<line x1="15" y1="9" x2="9" y2="15"/>
<line x1="9" y1="9" x2="15" y2="15"/>
</svg>
Letra maiúscula
</div>
<div class="password-hint invalid" id="numberHint">
<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2" aria-hidden="true">
<circle cx="12" cy="12" r="10"/>
<line x1="15" y1="9" x2="9" y2="15"/>
<line x1="9" y1="9" x2="15" y2="15"/>
</svg>
Pelo menos 1 número
</div>
</div>
<p id="password-err" class="error-message" role="alert" aria-live="polite"></p>
</div>
<div class="field">
<label for="confirmPassword" class="input-label">Confirmar senha</label>
<div class="input-wrapper">
<input type="password" id="confirmPassword" name="confirmPassword" class="input" autocomplete="new-password" placeholder="••••••••" required aria-required="true" aria-describedby="confirm-err"/>
<button type="button" class="toggle-password" id="toggleConfirmPassword" aria-label="Mostrar senha" aria-pressed="false">
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
<circle cx="12" cy="12" r="3"/>
</svg>
</button>
</div>
<p id="confirm-err" class="error-message" role="alert" aria-live="polite"></p>
</div>
<div class="terms">
<input type="checkbox" id="terms" name="terms" required aria-required="true" aria-describedby="terms-err"/>
<label for="terms">Eu concordo com os <a href="#">Termos de Serviço</a> e <a href="#">Política de Privacidade</a></label>
</div>
<p id="terms-err" class="error-message" role="alert" aria-live="polite"></p>
<div class="action-area">
<button type="submit" class="action-button" id="registerBtn">
<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
<circle cx="8.5" cy="7" r="4"/>
<path d="M20 8v6M17 11h6"/>
</svg>
Criar Conta
</button>
<div class="login-link">Já tem uma conta? <a href="/login">Fazer login</a></div>
</div>
</div>
</form>
</main>
<div class="notification" id="notification" role="alert" aria-live="assertive" aria-hidden="true" aria-atomic="true" tabindex="-1">
<svg class="notification-icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.6" aria-hidden="true">
<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
<path d="M22 4L12 14.01l-3-3"/>
</svg>
<div class="notification-content" id="notificationContent">Conta criada com sucesso!</div>
</div>
<script>
document.addEventListener("DOMContentLoaded",function(){
var form=document.getElementById("registerForm"),
username=document.getElementById("username"),
email=document.getElementById("email"),
password=document.getElementById("password"),
confirmPassword=document.getElementById("confirmPassword"),
registerBtn=document.getElementById("registerBtn"),
notification=document.getElementById("notification"),
notificationContent=document.getElementById("notificationContent"),
passwordStrength=document.getElementById("passwordStrength"),
lengthHint=document.getElementById("lengthHint"),
uppercaseHint=document.getElementById("uppercaseHint"),
numberHint=document.getElementById("numberHint"),
togglePassword=document.getElementById("togglePassword"),
toggleConfirmPassword=document.getElementById("toggleConfirmPassword"),
terms=document.getElementById("terms"),
usernameErr=document.getElementById("username-err"),
emailErr=document.getElementById("email-err"),
passwordErr=document.getElementById("password-err"),
confirmErr=document.getElementById("confirm-err"),
termsErr=document.getElementById("terms-err"),
passwordA11y=document.getElementById("passwordA11y");
function showNotification(message,isError){
notificationContent.textContent=message;
notification.classList.remove("error");
if(isError){
notification.classList.add("error")
}
notification.setAttribute("aria-hidden","false");
notification.classList.add("show");
notification.focus();
setTimeout(function(){
notification.classList.remove("show");
notification.setAttribute("aria-hidden","true")
},4000)
}
function validateEmail(v){
var re=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;
return re.test(v)
}
function validatePassword(p){
var hasMinLength=p.length>=8;
var hasUppercase=/[A-Z]/.test(p);
var hasNumber=/[0-9]/.test(p);
return{isValid:hasMinLength&&hasUppercase&&hasNumber,hasMinLength:hasMinLength,hasUppercase:hasUppercase,hasNumber:hasNumber}
}
function updateHints(val){
var v=validatePassword(val);
if(v.hasMinLength){
lengthHint.classList.remove("invalid");
lengthHint.classList.add("valid");
lengthHint.innerHTML='<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4L12 14.01l-3-3"/></svg>Mínimo de 8 caracteres'
}else{
lengthHint.classList.remove("valid");
lengthHint.classList.add("invalid");
lengthHint.innerHTML='<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>Mínimo de 8 caracteres'
}
if(v.hasUppercase){
uppercaseHint.classList.remove("invalid");
uppercaseHint.classList.add("valid");
uppercaseHint.innerHTML='<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4L12 14.01l-3-3"/></svg>Letra maiúscula'
}else{
uppercaseHint.classList.remove("valid");
uppercaseHint.classList.add("invalid");
uppercaseHint.innerHTML='<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>Letra maiúscula'
}
if(v.hasNumber){
numberHint.classList.remove("invalid");
numberHint.classList.add("valid");
numberHint.innerHTML='<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4L12 14.01l-3-3"/></svg>Pelo menos 1 número'
}else{
numberHint.classList.remove("valid");
numberHint.classList.add("invalid");
numberHint.innerHTML='<svg class="hint-icon" viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>Pelo menos 1 número'
}
}
function updatePasswordStrength(p){
var v=validatePassword(p);
passwordStrength.className="password-strength-meter";
passwordA11y.textContent="";
if(p.length>0){
if(v.isValid){
passwordStrength.classList.add("strong");
passwordA11y.textContent="Senha forte"
}else if(p.length>=8&&(v.hasUppercase||v.hasNumber)){
passwordStrength.classList.add("medium");
passwordA11y.textContent="Senha média"
}else{
passwordStrength.classList.add("weak");
passwordA11y.textContent="Senha fraca"
}
}
}
function setFieldError(input,el,msg){
if(msg){
input.classList.add("input-error");
input.setAttribute("aria-invalid","true");
el.textContent=msg
}else{
input.classList.remove("input-error");
input.removeAttribute("aria-invalid");
el.textContent=""
}
}
function validateForm(){
var ok=true;
if(username.value.trim()===""){
setFieldError(username,usernameErr,"Digite seu nome de usuário.");
ok=false
}else{
setFieldError(username,usernameErr,"")
}
if(!validateEmail(email.value)){
setFieldError(email,emailErr,"Digite um e-mail válido.");
ok=false
}else{
setFieldError(email,emailErr,"")
}
var pv=validatePassword(password.value);
if(!pv.isValid){
setFieldError(password,passwordErr,"A senha deve ter no mínimo 8 caracteres, ao menos 1 letra maiúscula e 1 número.");
ok=false
}else{
setFieldError(password,passwordErr,"")
}
if(password.value!==confirmPassword.value||confirmPassword.value.length===0){
setFieldError(confirmPassword,confirmErr,"As senhas não coincidem.");
ok=false
}else{
setFieldError(confirmPassword,confirmErr,"")
}
if(!terms.checked){
termsErr.textContent="Você precisa aceitar os termos para continuar.";
ok=false
}else{
termsErr.textContent=""
}
return ok
}
function togglePasswordVisibility(inputElement,buttonElement){
if(inputElement.type==="password"){
inputElement.type="text";
buttonElement.setAttribute("aria-pressed","true");
buttonElement.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>'
}else{
inputElement.type="password";
buttonElement.setAttribute("aria-pressed","false");
buttonElement.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>'
}
}
function maybeEnableButton(){
var basic=username.value.trim()!==""&&validateEmail(email.value)&&validatePassword(password.value).isValid&&confirmPassword.value===password.value&&terms.checked;
registerBtn.disabled=!basic
}
function applyServerError(msg){
showNotification(msg||"Erro ao criar conta.",true);
var m=(msg||"").toLowerCase();
var setAny=false;
if(m.includes("usuário")||m.includes("usuario")){
setFieldError(username,usernameErr,msg);
setAny=true
}
if(m.includes("e-mail")||m.includes("email")){
setFieldError(email,emailErr,msg);
setAny=true
}
if(m.includes("senha")&&m.includes("coincid")){
setFieldError(confirmPassword,confirmErr,msg);
setAny=true
}else if(m.includes("senha")){
setFieldError(password,passwordErr,msg);
setAny=true
}
if(m.includes("termo")){
termsErr.textContent=msg;
setAny=true
}
var firstInvalid=document.querySelector(".input.input-error")||document.querySelector(".terms input:not(:checked)");
if(firstInvalid&&firstInvalid.focus){
firstInvalid.focus()
}
}
password.addEventListener("input",function(){
updateHints(password.value);
updatePasswordStrength(password.value);
maybeEnableButton()
});
togglePassword.addEventListener("click",function(){
togglePasswordVisibility(password,togglePassword)
});
toggleConfirmPassword.addEventListener("click",function(){
togglePasswordVisibility(confirmPassword,toggleConfirmPassword)
});
username.addEventListener("input",function(){
if(username.value.trim()!==""){
setFieldError(username,usernameErr,"")
}
maybeEnableButton()
});
email.addEventListener("input",function(){
if(validateEmail(email.value)){
setFieldError(email,emailErr,"")
}
maybeEnableButton()
});
confirmPassword.addEventListener("input",function(){
if(password.value===confirmPassword.value){
setFieldError(confirmPassword,confirmErr,"")
}
maybeEnableButton()
});
terms.addEventListener("change",function(){
if(terms.checked){
terms.parentElement.style.color="var(--success)"
}else{
terms.parentElement.style.color="var(--muted-2)"
}
maybeEnableButton()
});
form.addEventListener("submit",async function(e){
e.preventDefault();
if(!validateForm()){
var firstInvalid=document.querySelector(".input.input-error")||document.querySelector(".terms input:not(:checked)");
if(firstInvalid&&firstInvalid.focus){
firstInvalid.focus()
}
showNotification("Revise os campos destacados para continuar.",true);
return
}
var originalHTML=registerBtn.innerHTML;
registerBtn.disabled=true;
registerBtn.innerHTML='<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4L12 14.01l-3-3"/></svg> Criando conta...';
try{
var fd=new FormData(form);
var res=await fetch("/register",{method:"POST",body:fd,credentials:"same-origin",headers:{Accept:"application/json, text/html"}});
if(!res.ok){
var ct=res.headers.get("content-type")||"";
if(ct.includes("application/json")){
var data=await res.json();
applyServerError(data&&data.error)
}else{
applyServerError("Erro ao criar conta.")
}
registerBtn.disabled=false;
registerBtn.innerHTML=originalHTML;
return
}
if(res.redirected&&res.url){
showNotification("Conta criada com sucesso! Redirecionando...",false);
setTimeout(function(){
window.location.href=res.url
},1200);
return
}
showNotification("Conta criada com sucesso! Redirecionando...",false);
setTimeout(function(){
window.location.href="/dashboard"
},1200)
}catch(err){
showNotification("Falha de rede. Tente novamente.",true);
registerBtn.disabled=false;
registerBtn.innerHTML=originalHTML
}
});
maybeEnableButton()
});
</script>
</body>
</html>
