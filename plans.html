<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Planos - ontercept</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
<script src="https://code.iconify.design/iconify-icon/1.0.8/iconify-icon.min.js"></script>
<style>
:root{--bg-0:#f5f7ff;--bg-1:#f8fbff;--surface:#ffffff;--muted:#6b7280;--muted-2:#54585f;--primary:#2463f0;--primary-600:#1f56d6;--accent:#7c3aed;--success:#10b981;--danger:#ef4444;--glass:rgba(255,255,255,0.65);--radius-sm:8px;--radius-md:12px;--radius-lg:16px;--radius-xl:18px;--shadow-sm:0 6px 18px rgba(16,24,40,0.06);--shadow-md:0 12px 32px rgba(16,24,40,0.08);--shadow-lg:0 22px 60px rgba(16,24,40,0.12);--shadow-primary:0 18px 50px rgba(36,99,240,0.18);--gap-1:8px;--gap-2:14px;--gap-3:20px;--gap-4:28px;--gap-5:36px;--transition:all 0.28s cubic-bezier(0.2,0.9,0.2,1);--glass-border:rgba(255,255,255,0.7)}
*{box-sizing:border-box;margin:0;padding:0}
html{font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;font-size:15px;line-height:1.55;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
body{min-height:100vh;background:linear-gradient(140deg,var(--bg-0) 0%,var(--bg-1) 100%);color:#0f172a;display:flex;flex-direction:column;align-items:center;padding:28px;gap:28px}
body::before{content:"";position:fixed;inset:0;background:radial-gradient(circle at 10% 10%,rgba(36,99,240,0.04) 0%,transparent 18%),radial-gradient(circle at 90% 90%,rgba(124,58,237,0.03) 0%,transparent 18%);z-index:-1;pointer-events:none}
.app-header{width:100%;max-width:1280px;background:linear-gradient(180deg,var(--glass),rgba(255,255,255,0.5));backdrop-filter:blur(10px);border-radius:20px;padding:14px 20px;display:flex;align-items:center;justify-content:space-between;box-shadow:var(--shadow-md);border:1px solid var(--glass-border);transition:var(--transition);position:sticky;top:18px;z-index:40}
.logo{display:flex;align-items:center;gap:12px;font-weight:800;font-size:18px;color:#0f172a}
.logo-image{height:44px;width:auto;display:block;object-fit:contain;transition:transform .35s cubic-bezier(.2,.9,.2,1)}
.logo-image:hover{transform:rotate(6deg) scale(1.03)}
.header-actions{display:flex;gap:10px;align-items:center;position:relative}
.icon-button{width:44px;height:44px;border-radius:12px;display:inline-flex;align-items:center;justify-content:center;background:transparent;border:none;color:var(--muted);cursor:pointer;transition:transform .18s ease,background .18s ease}
.icon-button:focus{outline:3px solid rgba(36,99,240,0.14);outline-offset:2px}
.icon-button:hover{transform:translateY(-4px);color:var(--primary);background:rgba(36,99,240,0.06)}
.icon-badge{position:absolute;top:-4px;right:-4px;width:18px;height:18px;border-radius:50%;background:var(--danger);color:white;font-size:10px;font-weight:700;display:flex;align-items:center;justify-content:center}
.user-dropdown{position:absolute;top:calc(100% + 10px);right:0;background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.92));backdrop-filter:blur(8px);border-radius:14px;padding:14px;box-shadow:var(--shadow-lg);min-width:280px;z-index:60;display:none;opacity:0;transform:translateY(8px);transition:opacity .18s ease,transform .18s ease}
.user-dropdown.show{display:block;opacity:1;transform:translateY(0)}
.user-info{display:flex;flex-direction:column;gap:6px;padding-bottom:12px;border-bottom:1px solid rgba(15,23,42,0.04);margin-bottom:12px}
.user-name{font-weight:800;font-size:15px;color:#0f172a}
.user-id{font-size:12px;color:var(--muted);font-weight:600}
.plan-pill{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;background:linear-gradient(90deg,rgba(36,99,240,0.06),rgba(124,58,237,0.03));border:1px solid rgba(36,99,240,0.08);font-weight:800;color:var(--primary);font-size:12px}
.update-plan-btn{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;border:none;background:transparent;color:var(--primary);font-weight:800;cursor:pointer;transition:transform .14s ease,width .2s ease}
.update-plan-btn:hover{transform:translateX(6px);background:rgba(36,99,240,0.04)}
.logout-btn{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;border:none;background:transparent;color:var(--danger);font-weight:800;cursor:pointer;transition:transform .14s ease}
.logout-btn:hover{transform:translateX(6px);background:rgba(239,68,68,0.04)}
.container{width:100%;max-width:1280px;display:flex;flex-direction:column;gap:28px}
.plans-header{text-align:center}
.plans-title{font-size:2.25rem;font-weight:900;color:#0f172a;margin-bottom:10px}
.plans-subtitle{font-size:1.05rem;color:var(--muted);max-width:820px;margin:0 auto}
.plans-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:24px;margin-top:22px}
@media (max-width:1100px){.plans-grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:680px){.plans-grid{grid-template-columns:1fr}}
.plan-card{background:linear-gradient(180deg,rgba(255,255,255,0.96),rgba(250,251,255,0.95));border-radius:18px;padding:22px;box-shadow:var(--shadow-sm);border:1px solid rgba(15,23,42,0.03);display:flex;flex-direction:column;gap:16px;transition:transform .22s cubic-bezier(.2,.9,.2,1),box-shadow .22s}
.plan-card.popular{border:2px solid var(--accent);box-shadow:var(--shadow-primary)}
.plan-card:hover{transform:translateY(-8px);box-shadow:var(--shadow-md)}
.plan-header{text-align:center}
.plan-name{font-size:1.35rem;font-weight:900;color:#0f172a;margin-bottom:6px}
.plan-price{display:flex;align-items:baseline;justify-content:center;gap:8px;margin-bottom:6px}
.price-amount{font-size:2.15rem;font-weight:900;color:var(--primary)}
.price-interval{font-size:0.95rem;color:var(--muted);font-weight:700}
.plan-description{color:var(--muted);font-size:0.95rem}
.plan-features{display:flex;flex-direction:column;gap:12px;margin-top:6px;flex-grow:1}
.feature{display:flex;align-items:center;gap:14px;font-weight:700;color:#0f172a}
.feature .ico{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:linear-gradient(135deg,rgba(36,99,240,0.06),rgba(124,58,237,0.04));border:1px solid rgba(36,99,240,0.06)}
.plan-button{width:100%;padding:14px;border-radius:14px;border:none;background:linear-gradient(90deg,var(--primary),var(--primary-600));color:white;font-weight:900;cursor:pointer;transition:transform .14s ease,box-shadow .14s ease;box-shadow:0 10px 30px rgba(36,99,240,0.14)}
.plan-button:hover{transform:translateY(-4px);box-shadow:0 20px 60px rgba(36,99,240,0.16)}
.plan-button.featured{background:linear-gradient(90deg,var(--accent),#8b5cf6)}
.faq-section{background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.96));padding:22px;border-radius:16px;border:1px solid rgba(15,23,42,0.03);box-shadow:var(--shadow-sm)}
.faq-title{font-size:1.25rem;font-weight:900;text-align:center;margin-bottom:14px}
.faq-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
@media (max-width:720px){.faq-grid{grid-template-columns:1fr}}
.faq-item{background:rgba(255,255,255,0.95);padding:16px;border-radius:12px;border:1px solid rgba(15,23,42,0.03)}
.faq-question{font-weight:900;color:#0f172a;margin-bottom:8px}
.faq-answer{color:var(--muted)}
.modal-backdrop{position:fixed;inset:0;background:rgba(15,23,42,0.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:80}
.modal-backdrop.show{display:flex}
.modal{width:100%;max-width:760px;background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(250,251,255,0.96));border-radius:16px;padding:18px;box-shadow:var(--shadow-lg);border:1px solid rgba(255,255,255,0.6);display:flex;flex-direction:column;gap:14px;outline:none}
.modal-close{position:absolute;top:12px;right:12px;background:rgba(15,23,42,0.6);color:#fff;width:36px;height:36px;border-radius:10px;border:none;display:inline-flex;align-items:center;justify-content:center}
.input{width:100%;padding:11px 12px;border-radius:12px;border:1px solid rgba(15,23,42,0.06);background:rgba(255,255,255,0.95);outline:none}
.valid{border-color:var(--success);box-shadow:0 6px 20px rgba(16,185,129,0.06)}
.invalid{border-color:var(--danger);box-shadow:0 6px 20px rgba(239,68,68,0.06)}
.kv{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.kv .box{background:rgba(255,255,255,0.95);border:1px solid rgba(15,23,42,0.03);border-radius:10px;padding:10px}
.cta-row{display:flex;gap:12px;justify-content:space-between;align-items:center}
.cta-price{font-weight:900}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,rgba(36,99,240,0.06),rgba(124,58,237,0.04));border:1px solid rgba(36,99,240,0.08);font-weight:800;color:var(--primary);font-size:12px}
</style>
</head>
<body>
<header class="app-header" role="banner">
  <div class="logo">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="ontercept" class="logo-image">
  </div>
  <div class="header-actions" role="toolbar" aria-label="Ações">
    <div style="position:relative;">
      <button class="icon-button" id="notificationsBtn" aria-label="Notificações" aria-haspopup="true" aria-controls="notificationsDropdown" aria-expanded="false" type="button">
        <iconify-icon icon="lucide:bell" width="20" height="20"></iconify-icon>
        <span class="icon-badge" id="notifBadge">3</span>
      </button>
      <div class="notifications-dropdown" id="notificationsDropdown" role="menu" aria-hidden="true" style="position:absolute;top:100%;right:56px;background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.94));backdrop-filter:blur(8px);border-radius:12px;padding:12px;box-shadow:var(--shadow-lg);min-width:320px;display:none;opacity:0;transform:translateY(8px);transition:opacity .2s ease,transform .2s ease;border:1px solid rgba(255,255,255,0.6);">
        <div class="notif-item" role="menuitem" style="display:flex;gap:10px;padding:10px;border-radius:10px;background:rgba(0,0,0,0.02);margin-bottom:8px">
          <div style="width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;color:white;font-weight:800">N</div>
          <div>
            <div style="font-weight:700;color:#0f172a">Atualização do sistema</div>
            <div style="font-size:13px;color:var(--muted)">Nova versão disponível para atualização</div>
          </div>
        </div>
        <div class="notif-item" role="menuitem" style="display:flex;gap:10px;padding:10px;border-radius:10px;background:rgba(0,0,0,0.02);margin-bottom:8px">
          <div style="width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;color:white;font-weight:800">P</div>
          <div>
            <div style="font-weight:700;color:#0f172a">Pagamento recebido</div>
            <div style="font-size:13px;color:var(--muted)">Cobrança via PIX confirmada</div>
          </div>
        </div>
        <div class="notif-item" role="menuitem" style="display:flex;gap:10px;padding:10px;border-radius:10px;background:rgba(0,0,0,0.02)">
          <div style="width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;color:white;font-weight:800">S</div>
          <div>
            <div style="font-weight:700;color:#0f172a">Suporte</div>
            <div style="font-size:13px;color:var(--muted)">Resposta do suporte em 2 horas</div>
          </div>
        </div>
      </div>
    </div>

<div style="position:relative;">
  <button class="icon-button" id="userBtn" aria-label="Configurações do usuário" aria-haspopup="true" aria-controls="userDropdown" aria-expanded="false" type="button">
    <iconify-icon icon="lucide:settings-2" width="20" height="20"></iconify-icon>
  </button>
  <div class="user-dropdown" id="userDropdown" role="menu" aria-hidden="true">
    <div class="user-info">
      <div class="user-name" id="dropdownUserName">Carregando...</div>
      <div class="user-id" id="dropdownUserId">ID: Carregando...</div>
    </div>
    <div style="margin-bottom:12px;display:flex;flex-direction:column;gap:10px;">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
        <div class="plan-pill inactive" id="userPlanPill" aria-hidden="true">
          <iconify-icon icon="lucide:badge" width="16" height="16"></iconify-icon>
          <span id="userPlanText">Sem Plano</span>
        </div>
        <div aria-hidden="true" style="font-size:12px;color:var(--muted)">Plano atual</div>
      </div>
      <button id="updatePlanBtn" class="update-plan-btn" aria-label="Atualizar plano" type="button">
        <iconify-icon icon="lucide:chevrons-up" width="18" height="18"></iconify-icon>Atualizar plano
      </button>
      <button id="supportBtn" class="update-plan-btn" aria-label="Suporte via WhatsApp" type="button" style="background:transparent;color:var(--muted);font-weight:700">
        <iconify-icon icon="lucide:phone-call" width="18" height="18"></iconify-icon>Suporte (WhatsApp)
      </button>
    </div>
    <button class="logout-btn" id="logoutBtn" aria-label="Sair" type="button">
      <iconify-icon icon="lucide:log-out" width="18" height="18"></iconify-icon>Sair
    </button>
  </div>
</div>

  </div>
</header>

<div class="container">
  <div class="plans-header">
    <h1 class="plans-title">Escolha o Plano Perfeito</h1>
    <p class="plans-subtitle">Maximize sua capacidade com planos pensados para diferentes necessidades. Todos incluem suporte via WhatsApp e atualizações constantes.</p>
  </div>

  <div class="plans-grid" id="plansGrid">
    <div class="plan-card" data-plan-code="basic15">
      <div class="plan-header">
        <h2 class="plan-name">Básico</h2>
        <div class="plan-price"><span class="price-amount">R$35</span><span class="price-interval">/15 dias</span></div>
        <p class="plan-description">Para uso ocasional e testes rápidos.</p>
      </div>
      <div class="plan-features">
        <div class="feature"><div class="ico"><iconify-icon icon="lucide:zap" width="18" height="18"></iconify-icon></div><span>5 interceptações por dia</span></div>
        <div class="feature"><div class="ico"><iconify-icon icon="lucide:calendar" width="18" height="18"></iconify-icon></div><span>Duração: 15 dias</span></div>
        <div class="feature"><div class="ico"><iconify-icon icon="lucide:phone-call" width="18" height="18"></iconify-icon></div><span>Suporte via WhatsApp</span></div>
        <div class="feature"><div class="ico"><iconify-icon icon="lucide:layers" width="18" height="18"></iconify-icon></div><span>Acesso às funcionalidades básicas</span></div>
      </div>
      <button class="plan-button pulse" type="button">Selecionar Plano</button>
    </div>

<div class="plan-card popular" data-plan-code="std30">
  <div class="plan-header">
    <h2 class="plan-name">Padrão</h2>
    <div class="plan-price"><span class="price-amount">R$50</span><span class="price-interval">/30 dias</span></div>
    <p class="plan-description">Equilíbrio entre custo e capacidade para uso regular.</p>
  </div>
  <div class="plan-features">
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:zap" width="18" height="18"></iconify-icon></div><span>10 interceptações por dia</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:calendar" width="18" height="18"></iconify-icon></div><span>Duração: 30 dias</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:star" width="18" height="18"></iconify-icon></div><span>Suporte prioritário via WhatsApp</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:layers" width="18" height="18"></iconify-icon></div><span>Acesso a todas as funcionalidades</span></div>
  </div>
  <button class="plan-button" type="button">Selecionar Plano</button>
</div>

<div class="plan-card popular featured" data-plan-code="pro30">
  <div class="plan-header">
    <h2 class="plan-name">Avançado</h2>
    <div class="plan-price"><span class="price-amount">R$97</span><span class="price-interval">/30 dias</span></div>
    <p class="plan-description">Ideal para profissionais e equipes com alto volume.</p>
  </div>
  <div class="plan-features">
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:zap" width="18" height="18"></iconify-icon></div><span>25 interceptações por dia</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:calendar" width="18" height="18"></iconify-icon></div><span>Duração: 30 dias</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:headphones" width="18" height="18"></iconify-icon></div><span>Suporte 24/7 via WhatsApp</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:bar-chart-2" width="18" height="18"></iconify-icon></div><span>Relatórios avançados</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:shield-check" width="18" height="18"></iconify-icon></div><span>Segurança e prioridade</span></div>
  </div>
  <button class="plan-button featured" type="button">Selecionar Plano</button>
</div>

<div class="plan-card" data-plan-code="life">
  <div class="plan-header">
    <h2 class="plan-name">Vitalício</h2>
    <div class="plan-price"><span class="price-amount">R$139</span><span class="price-interval">/vitalício</span></div>
    <p class="plan-description">Acesso permanente para quem não quer se preocupar.</p>
  </div>
  <div class="plan-features">
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:infinite" width="18" height="18"></iconify-icon></div><span>20 interceptações por dia</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:award" width="18" height="18"></iconify-icon></div><span>Duração: Vitalícia</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:headphones" width="18" height="18"></iconify-icon></div><span>Suporte 24/7 prioritário</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:bar-chart-2" width="18" height="18"></iconify-icon></div><span>Relatórios avançados</span></div>
    <div class="feature"><div class="ico"><iconify-icon icon="lucide:repeat" width="18" height="18"></iconify-icon></div><span>Atualizações gratuitas para sempre</span></div>
  </div>
  <button class="plan-button" type="button">Selecionar Plano</button>
</div>

  </div>

  <div class="faq-section">
    <h2 class="faq-title">Perguntas Frequentes</h2>
    <div class="faq-grid">
      <div class="faq-item">
        <h3 class="faq-question">Como funciona a cobrança?</h3>
        <p class="faq-answer">Cobrança única sem renovação automática. Você paga apenas uma vez pelo período selecionado.</p>
      </div>
      <div class="faq-item">
        <h3 class="faq-question">Posso alterar meu plano depois?</h3>
        <p class="faq-answer">Sim, é possível fazer upgrade a qualquer momento. Entre em contato com nosso suporte para auxílio na migração.</p>
      </div>
      <div class="faq-item">
        <h3 class="faq-question">Há reembolso disponível?</h3>
        <p class="faq-answer">Reembolso em até 7 dias após a compra, desde que o limite de interceptações não tenha sido excedido.</p>
      </div>
      <div class="faq-item">
        <h3 class="faq-question">Quais métodos de pagamento são aceitos?</h3>
        <p class="faq-answer">Atualmente aceitamos PIX. Integrações com outros meios serão avaliadas.</p>
      </div>
    </div>
  </div>
</div>

<div class="modal-backdrop" id="planModal" role="dialog" aria-modal="true" aria-labelledby="planModalTitle" aria-hidden="true">
  <div class="modal" id="planModalCard" tabindex="-1">
    <button class="modal-close" id="planModalClose" aria-label="Fechar" type="button">
      <iconify-icon icon="lucide:x" width="18" height="18"></iconify-icon>
    </button>
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
      <div style="display:flex;gap:12px;align-items:center">
        <div style="width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800">
          <iconify-icon icon="lucide:shield-check" width="18" height="18"></iconify-icon>
        </div>
        <div style="font-weight:900;font-size:1rem" id="planModalTitle">Detalhes do plano</div>
      </div>
      <div class="meta-pills" style="display:flex;gap:8px">
        <div class="pill">PIX</div>
        <div class="pill">Suporte</div>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
      <div style="display:grid;gap:12px">
        <div style="background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(250,251,255,0.96));border-radius:12px;padding:12px;border:1px solid rgba(15,23,42,0.03)">
          <div style="display:flex;align-items:center;justify-content:space-between">
            <div style="font-weight:900" id="modalPlanName">Plano</div>
            <span class="badge" id="modalPlanBadge">Selecionado</span>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px">
            <div class="kv"><div class="box"><b>Preço</b><div id="modalPlanPrice">—</div></div></div>
            <div class="kv"><div class="box"><b>Período</b><div id="modalPlanPeriod">—</div></div></div>
            <div class="kv"><div class="box"><b>Interceptações/dia</b><div id="modalPlanLimit">—</div></div></div>
            <div class="kv"><div class="box"><b>Suporte</b><div id="modalPlanSupport">WhatsApp</div></div></div>
          </div>
        </div>
      </div>
      <form class="form" id="checkoutForm" novalidate style="display:grid;gap:12px">
        <div class="field"><label class="label" for="fullname">Nome completo</label><input class="input" id="fullname" name="fullname" type="text" autocomplete="name" placeholder="Seu nome completo" required/></div>
        <div class="field"><label class="label" for="cpf">CPF (somente números)</label><input class="input" id="cpf" name="cpf" type="text" inputmode="numeric" pattern="\d{11}" maxlength="11" placeholder="Apenas números" required/></div>
      </form>
    </div>
    <div style="display:flex;flex-direction:column;gap:12px">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
        <div style="display:flex;flex-direction:column">
          <div class="cta-price" id="ctaPlanName">Plano</div>
          <div id="ctaPlanPrice">—</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="update-plan-btn" id="planModalCancel" type="button">Cancelar</button>
          <button class="plan-button" id="planModalConfirm" disabled type="button">Liberar acesso agora</button>
        </div>
      </div>
      <div style="background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(250,251,255,0.95));padding:12px;border-radius:12px;border:1px solid rgba(15,23,42,0.03);display:grid;gap:8px">
        <div style="display:flex;gap:10px;align-items:flex-start"><iconify-icon icon="lucide:info" width="16" height="16"></iconify-icon><div><b>Por que pedimos seu nome e CPF:</b> utilizados para validação e cobrança via processadora. Não armazenamos estes dados em nossos servidores.</div></div>
        <div style="display:flex;gap:10px;align-items:flex-start"><iconify-icon icon="lucide:key" width="16" height="16"></iconify-icon><div><b>Use o mesmo CPF:</b> o CPF do formulário deve coincidir com o CPF usado no pagamento PIX.</div></div>
        <div style="display:flex;gap:10px;align-items:flex-start"><iconify-icon icon="lucide:clock" width="16" height="16"></iconify-icon><div><b>Ativação imediata:</b> após confirmação do pagamento o plano é ativado automaticamente.</div></div>
      </div>
    </div>
  </div>
</div>

<span class="sr-only" id="srStatus" role="status" aria-live="polite"></span>

<script>
document.addEventListener('DOMContentLoaded',function(){
var userBtn=document.getElementById('userBtn'),userDropdown=document.getElementById('userDropdown'),notificationsBtn=document.getElementById('notificationsBtn'),notificationsDropdown=document.getElementById('notificationsDropdown'),logoutBtn=document.getElementById('logoutBtn'),planButtons=document.querySelectorAll('.plan-button'),planModal=document.getElementById('planModal'),planModalCard=document.getElementById('planModalCard'),planModalClose=document.getElementById('planModalClose'),planModalCancel=document.getElementById('planModalCancel'),planModalConfirm=document.getElementById('planModalConfirm'),srStatus=document.getElementById('srStatus'),modalPlanName=document.getElementById('modalPlanName'),modalPlanPrice=document.getElementById('modalPlanPrice'),modalPlanPeriod=document.getElementById('modalPlanPeriod'),modalPlanLimit=document.getElementById('modalPlanLimit'),modalPlanSupport=document.getElementById('modalPlanSupport'),badgeText=document.getElementById('badgeText'),ctaPlanName=document.getElementById('ctaPlanName'),ctaPlanPrice=document.getElementById('ctaPlanPrice'),fullnameInput=document.getElementById('fullname'),cpfInput=document.getElementById('cpf'),activeTrigger=null,focusableSelectors='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),[tabindex]:not([tabindex="-1"])',selectedPlanCode=null,dropdownUserName=document.getElementById('dropdownUserName'),dropdownUserId=document.getElementById('dropdownUserId'),userPlanPill=document.getElementById('userPlanPill'),userPlanText=document.getElementById('userPlanText'),updatePlanBtn=document.getElementById('updatePlanBtn'),supportBtn=document.getElementById('supportBtn'),notifBadge=document.getElementById('notifBadge');
function fetchUserData(){fetch('/api/me',{credentials:'include'}).then(function(response){if(!response.ok){return {ok:false};}return response.json()}).then(function(data){if(data&&data.ok&&data.user){var userData=data.user;var planData=data.plan||{};var planName=planData.name||'Sem Plano';dropdownUserName.textContent=userData.username||'Usuário';dropdownUserId.textContent='ID: '+(userData.id||'—');if(planData.active){userPlanText.textContent=planName;userPlanPill.classList.remove('inactive')}else{userPlanText.textContent='Sem Plano';userPlanPill.classList.add('inactive')}if(typeof data.notifications_count!=='undefined'){notifBadge.textContent=String(data.notifications_count)}else{notifBadge.style.display='none'}}else{dropdownUserName.textContent='Convidado';dropdownUserId.textContent='ID: —';userPlanText.textContent='Sem Plano';userPlanPill.classList.add('inactive');notifBadge.style.display='none'}}).catch(function(){dropdownUserName.textContent='Convidado';dropdownUserId.textContent='ID: —';userPlanText.textContent='Sem Plano';userPlanPill.classList.add('inactive');notifBadge.style.display='none'})}
function openUserDropdown(){userDropdown.classList.add('show');userDropdown.setAttribute('aria-hidden','false');userBtn.setAttribute('aria-expanded','true');var first=userDropdown.querySelector('button, a, [tabindex]:not([tabindex="-1"])');if(first)first.focus()}
function closeUserDropdown(){userDropdown.classList.remove('show');userDropdown.setAttribute('aria-hidden','true');userBtn.setAttribute('aria-expanded','false')}
function openNotificationsDropdown(){if(notificationsDropdown){notificationsDropdown.classList.add('show');notificationsDropdown.setAttribute('aria-hidden','false');notificationsBtn.setAttribute('aria-expanded','true')}}
function closeNotificationsDropdown(){if(notificationsDropdown){notificationsDropdown.classList.remove('show');notificationsDropdown.setAttribute('aria-hidden','true');notificationsBtn.setAttribute('aria-expanded','false')}}
userBtn.addEventListener('click',function(e){e.stopPropagation();if(userDropdown.classList.contains('show')){closeUserDropdown()}else{openUserDropdown();closeNotificationsDropdown()}});userBtn.addEventListener('keydown',function(e){if(e.key==='Enter'||e.key===' '){e.preventDefault();if(userDropdown.classList.contains('show')){closeUserDropdown()}else{openUserDropdown();closeNotificationsDropdown()}}});
notificationsBtn.addEventListener('click',function(e){e.stopPropagation();if(notificationsDropdown&&notificationsDropdown.classList.contains('show')){closeNotificationsDropdown()}else{openNotificationsDropdown();closeUserDropdown()}});notificationsBtn.addEventListener('keydown',function(e){if(e.key==='Enter'||e.key===' '){e.preventDefault();if(notificationsDropdown&&notificationsDropdown.classList.contains('show')){closeNotificationsDropdown()}else{openNotificationsDropdown();closeUserDropdown()}}});
document.addEventListener('click',function(e){if(!e.target.closest('.user-dropdown')&&!e.target.closest('#userBtn')){closeUserDropdown()}if(!e.target.closest('.notifications-dropdown')&&!e.target.closest('#notificationsBtn')){closeNotificationsDropdown()}});
document.addEventListener('keydown',function(e){if(e.key==='Escape'){closeUserDropdown();closeNotificationsDropdown();closeModal()}});
logoutBtn.addEventListener('click',function(){window.location.href='/logout'});
updatePlanBtn&&updatePlanBtn.addEventListener('click',function(){window.location.href='/plans'});
supportBtn&&supportBtn.addEventListener('click',function(){window.open('https://wa.me/5511941153647','_blank')});
function announce(m){srStatus.textContent=m;setTimeout(function(){srStatus.textContent=''},2500)}
function fillModal(card){if(!card)return;var name=card.querySelector('.plan-name').textContent.trim();var price=card.querySelector('.price-amount').textContent.trim();var period=card.querySelector('.price-interval').textContent.replace('/','').trim();var features=[].map.call(card.querySelectorAll('.feature'),function(x){return x.textContent.trim()});var limit=(features.find(function(t){return t.toLowerCase().includes('interceptações')})||'—').replace(/\D+/g,'');var support=(features.find(function(t){return t.toLowerCase().includes('whatsapp')})||'WhatsApp').replace('Suporte ','');selectedPlanCode=card.getAttribute('data-plan-code')||null;modalPlanName.textContent=name;modalPlanPrice.textContent=price;modalPlanPeriod.textContent=period;modalPlanLimit.textContent=limit||'—';modalPlanSupport.textContent=support;badgeText&& (badgeText.textContent='Selecionado');ctaPlanName.textContent=name;ctaPlanPrice.textContent=price;announce('Detalhes do plano '+name+' abertos.')}
function lockBodyScroll(lock){document.documentElement.style.overflow=lock?'hidden':'';document.body.style.overflow=lock?'hidden':''}
function openModal(){planModal.classList.add('show');planModal.setAttribute('aria-hidden','false');planModalCard.classList.add('show');lockBodyScroll(true);setTimeout(function(){fullnameInput&&fullnameInput.focus()},60)}
function closeModal(){planModal.classList.remove('show');planModal.setAttribute('aria-hidden','true');planModalCard.classList.remove('show');lockBodyScroll(false);activeTrigger&&activeTrigger.focus()}
planButtons.forEach(function(button){button.addEventListener('click',function(){var card=this.closest('.plan-card');activeTrigger=this;fillModal(card);openModal()})});
planModal.addEventListener('click',function(e){if(e.target===planModal){closeModal()}});
planModalClose.addEventListener('click',function(){closeModal()});
planModalCancel.addEventListener('click',function(){closeModal()});
function trap(e){if(!planModal.classList.contains('show'))return;var focusable=planModalCard.querySelectorAll(focusableSelectors);if(!focusable.length)return;var first=focusable[0],last=focusable[focusable.length-1];if(e.key==='Tab'){if(e.shiftKey&&document.activeElement===first){e.preventDefault();last.focus()}else if(!e.shiftKey&&document.activeElement===last){e.preventDefault();first.focus()}}}
document.addEventListener('keydown',trap);
function validate(){var full=fullnameInput.value.trim();var cpf=cpfInput.value.trim();var fullOk=/^[A-Za-zÀ-ÖØ-öø-ÿ'’-]+(?:\s+[A-Za-zÀ-ÖØ-öø-ÿ'’-]+)+$/.test(full);var cpfOk=/^\d{11}$/.test(cpf);fullnameInput.classList.toggle('valid',fullOk);fullnameInput.classList.toggle('invalid',!fullOk&&full.length>0);cpfInput.classList.toggle('valid',cpfOk);cpfInput.classList.toggle('invalid',!cpfOk&&cpf.length>0);planModalConfirm.disabled=!(fullOk&&cpfOk&&!!selectedPlanCode)}
fullnameInput&&fullnameInput.addEventListener('input',validate);
cpfInput&&cpfInput.addEventListener('input',function(){this.value=this.value.replace(/\D+/g,'').slice(0,11);validate()});
var PLAN_CODE_TO_KEY={basic15:'basic-15',std30:'standard-30',pro30:'advanced-30',life:'lifetime'};
async function startCheckout(){var full=fullnameInput.value.trim();var cpf=cpfInput.value.trim();if(planModalConfirm.disabled)return;if(!selectedPlanCode){announce('Plano inválido.');return}var plan_key=PLAN_CODE_TO_KEY[selectedPlanCode];if(!plan_key){announce('Plano inválido.');return}planModalConfirm.disabled=true;var original=planModalConfirm.textContent;planModalConfirm.textContent='Gerando Pix...';try{var r=await fetch('/api/pay/create',{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},credentials:'same-origin',body:JSON.stringify({plan_key:plan_key,fullname:full,cpf:cpf})});var ct=r.headers.get('content-type')||'';if(!ct.includes('application/json')){window.location.href='/login';return}var data=await r.json();if(!r.ok||!data.ok||!data.redirect){announce(data&&data.error?data.error:'Falha ao criar cobrança.');planModalConfirm.disabled=false;planModalConfirm.textContent=original;return}window.location.href=data.redirect}catch(e){announce('Não foi possível criar a cobrança agora. Tente novamente.');planModalConfirm.disabled=false;planModalConfirm.textContent=original}}
planModalConfirm.addEventListener('click',function(){startCheckout()});
function resetModalForm(){if(fullnameInput)fullnameInput.value='';if(cpfInput)cpfInput.value='';fullnameInput&&fullnameInput.classList.remove('valid','invalid');cpfInput&&cpfInput.classList.remove('valid','invalid');validate()}
planModalClose.addEventListener('click',resetModalForm);
planModalCancel.addEventListener('click',resetModalForm);
fetchUserData()
});
</script>

</body>
</html>
