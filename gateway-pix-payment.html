<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Pagamento via Pix - ontercept</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"/>
<script src="https://code.iconify.design/iconify-icon/1.0.8/iconify-icon.min.js"></script>
<style>
:root{--bg-0:#eef2ff;--bg-1:#f8fafc;--surface:#ffffff;--muted:#6b7280;--muted-2:#54585f;--primary:#2463f0;--primary-600:#1f56d6;--accent:#7c3aed;--success:#10b981;--danger:#ef4444;--warning:#f59e0b;--glass:rgba(255,255,255,0.6);--radius-sm:8px;--radius-md:12px;--radius-lg:16px;--radius-xl:18px;--shadow-sm:0 6px 12px rgba(16,24,40,0.06);--shadow-md:0 10px 24px rgba(16,24,40,0.08);--shadow-lg:0 18px 42px rgba(16,24,40,0.12);--shadow-primary:0 10px 30px rgba(36,99,240,0.2);--gap-1:8px;--gap-2:14px;--gap-3:20px;--gap-4:28px;--gap-5:36px;--transition:all 0.25s cubic-bezier(0.4,0,0.2,1)}
html{font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;font-size:15px;line-height:1.55;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;scroll-behavior:smooth}
*{box-sizing:border-box;margin:0;padding:0}
body{margin:0;min-height:100vh;background:linear-gradient(160deg,var(--bg-0) 0%,var(--bg-1) 100%);color:#111827;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:20px 18px 36px;position:relative;overflow-x:hidden}
body::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 12% 18%,rgba(36,99,240,0.06) 0%,transparent 22%),radial-gradient(circle at 88% 74%,rgba(124,58,237,0.06) 0%,transparent 22%);pointer-events:none;z-index:-1}
header.app-header{width:100%;max-width:1280px;background:linear-gradient(180deg,rgba(255,255,255,0.72),rgba(255,255,255,0.5));backdrop-filter:blur(12px);border-radius:var(--radius-xl);padding:12px 18px;display:flex;align-items:center;justify-content:space-between;box-shadow:var(--shadow-md);border:1px solid rgba(255,255,255,0.5);margin-bottom:24px;transition:var(--transition);position:sticky;top:16px;z-index:100}
header.app-header:hover{box-shadow:var(--shadow-lg);transform:translateY(-2px)}
.logo{display:flex;align-items:center;gap:12px;font-weight:800;font-size:18px;color:#0f172a;letter-spacing:-0.4px}
.logo-image{height:44px;width:auto;border-radius:0;object-fit:contain;display:block;box-shadow:none;background:transparent;transition:var(--transition)}
.logo:hover .logo-image{transform:rotate(6deg) scale(1.02)}
.header-actions{display:flex;gap:10px;align-items:center;position:relative}
.icon-button{width:40px;height:40px;border-radius:12px;display:inline-flex;align-items:center;justify-content:center;background:transparent;border:none;color:var(--muted);cursor:pointer;transition:var(--transition);position:relative}
.icon-button:hover{transform:translateY(-2px);color:var(--primary);background:rgba(36,99,240,0.08);box-shadow:var(--shadow-sm)}
.icon-badge{position:absolute;top:-4px;right:-4px;width:18px;height:18px;border-radius:50%;background:var(--danger);color:white;font-size:10px;font-weight:700;display:flex;align-items:center;justify-content:center}
.user-dropdown{position:absolute;top:100%;right:0;background:rgba(255,255,255,0.96);backdrop-filter:blur(10px);border-radius:var(--radius-lg);padding:16px;box-shadow:var(--shadow-lg);min-width:240px;z-index:1000;display:none;margin-top:10px;border:1px solid rgba(255,255,255,0.6);opacity:0;transform:translateY(8px);transition:opacity .2s ease,transform .2s ease}
.user-dropdown.show{display:block;opacity:1;transform:translateY(0)}
.user-info{display:flex;flex-direction:column;gap:6px;padding-bottom:12px;border-bottom:1px solid rgba(0,0,0,0.05);margin-bottom:12px}
.user-name{font-weight:700;font-size:15px;color:#0f172a}
.user-id{font-size:12px;color:var(--muted);font-weight:500}
.plan-pill{display:inline-flex;align-items:center;gap:8px;padding:7px 9px;border-radius:999px;background:linear-gradient(90deg,rgba(36,99,240,0.06),rgba(124,58,237,0.03));border:1px solid rgba(36,99,240,0.08);font-weight:700;color:var(--primary);font-size:12px}
.plan-pill.inactive{background:linear-gradient(90deg,rgba(239,68,68,0.1),rgba(239,68,68,0.05));border:1px solid rgba(239,68,68,0.2);color:var(--danger)}
.update-plan-btn{display:flex;align-items:center;gap:10px;padding:9px;border-radius:10px;border:none;background:transparent;color:var(--primary);font-weight:700;cursor:pointer;transition:var(--transition);width:100%}
.update-plan-btn:hover{background:rgba(36,99,240,0.06);transform:translateX(3px)}
.logout-btn{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;border:none;background:transparent;color:var(--danger);font-weight:600;cursor:pointer;transition:var(--transition);width:100%}
.logout-btn:hover{background:rgba(239,68,68,0.08);transform:translateX(3px)}
.focus-ring:focus-visible{outline:3px solid rgba(36,99,240,0.5);outline-offset:2px}
.whatsapp-fa{color:var(--primary);font-size:18px;line-height:1;display:inline-block;vertical-align:middle}
.main-container{width:100%;max-width:1280px;display:flex;flex-direction:column;gap:var(--gap-4)}
.section-header{text-align:center;margin-bottom:var(--gap-2)}
.title{display:flex;align-items:center;gap:10px;justify-content:center;font-size:2.125rem;font-weight:800;color:#0f172a;margin-bottom:var(--gap-2);letter-spacing:-0.5px}
.subtitle{font-size:1.05rem;color:var(--muted);max-width:720px;margin:0 auto;line-height:1.6}
.pay-card{background:linear-gradient(180deg,rgba(255,255,255,0.86),rgba(251,253,255,0.72));backdrop-filter:blur(12px);border-radius:18px;padding:22px;box-shadow:var(--shadow-lg);border:1px solid rgba(255,255,255,0.64);transition:var(--transition);display:grid;gap:20px}
.pay-card:hover{transform:translateY(-2px)}
.meta-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between}
.pill{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;background:linear-gradient(90deg,rgba(36,99,240,0.08),rgba(124,58,237,0.05));border:1px solid rgba(36,99,240,0.12);font-weight:800;color:var(--primary);font-size:12px}
.timer{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;background:rgba(15,23,42,0.06);font-weight:800;color:#0f172a;border:1px solid rgba(15,23,42,0.08)}
.timer.expired{background:rgba(239,68,68,0.08);color:#991b1b;border-color:rgba(239,68,68,0.25)}
.pay-grid{display:grid;grid-template-columns:1fr 1fr;gap:22px}
@media (max-width:900px){.pay-grid{grid-template-columns:1fr}}
.qr-pane{display:grid;gap:14px;align-content:start}
.qr-card{background:rgba(255,255,255,0.75);border:1px solid rgba(0,0,0,0.06);border-radius:14px;padding:18px;display:grid;gap:12px;align-items:center;justify-items:center}
.qr-img{width:100%;max-width:360px;border-radius:12px;box-shadow:0 6px 18px rgba(16,24,40,0.10);background:#fff}
.copy-btn{padding:14px 16px;border-radius:14px;border:none;background:linear-gradient(90deg,var(--primary),var(--primary-600));color:#fff;font-weight:800;cursor:pointer;transition:var(--transition);box-shadow:var(--shadow-primary);background-size:200% 100%;display:inline-flex;align-items:center;gap:10px;justify-content:center}
.copy-btn:hover{transform:translateY(-1px);background-position:100% 0}
.copy-btn[disabled]{opacity:.6;cursor:not-allowed;filter:saturate(.7)}
.field{display:grid;gap:8px}
.label{font-size:.9rem;font-weight:800;color:#0f172a;display:flex;align-items:center;gap:8px}
.code-input{min-height:160px;border:1px solid rgba(0,0,0,0.1);border-radius:12px;padding:12px 12px;outline:none;background:rgba(255,255,255,0.95);font-size:.92rem;line-height:1.5;box-shadow:var(--shadow-sm);font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;word-break:break-all}
.instructions{background:linear-gradient(180deg,rgba(255,255,255,0.8),rgba(251,253,255,0.72));border:1px solid rgba(0,0,0,0.04);border-radius:14px;padding:14px;display:grid;gap:10px}
.instructions p{color:#111827;display:flex;gap:8px;align-items:flex-start}
.inline-icon{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.pulse{animation:pulse 2s infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(36,99,240,0.4)}70%{box-shadow:0 0 0 10px rgba(36,99,240,0)}100%{box-shadow:0 0 0 0 rgba(36,99,240,0)}}
@media (prefers-reduced-motion:reduce){.pulse{animation:none!important}*{scroll-behavior:auto}}
.plan-summary{background:linear-gradient(180deg,rgba(255,255,255,0.8),rgba(251,253,255,0.72));border:1px solid rgba(0,0,0,0.06);border-radius:14px;padding:14px;display:grid;gap:10px;margin-top:0}
.kv{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.kv div{background:rgba(255,255,255,0.75);border:1px solid rgba(0,0,0,0.04);border-radius:12px;padding:10px}
.kv b{display:block;color:#0f172a;font-size:.86rem;margin-bottom:4px}
.toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:#0f172a;color:#fff;padding:12px 16px;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.2);font-weight:800;z-index:2000;opacity:0;transition:opacity .18s ease,transform .18s ease}
.toast.show{opacity:1;transform:translateX(-50%) translateY(-6px)}
</style>
</head>
<body>
<header class="app-header" role="banner">
  <div class="logo">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="ontercept" class="logo-image">
  </div>
  <div class="header-actions" role="toolbar" aria-label="Ações">
    <button class="icon-button focus-ring" id="notificationsBtn" aria-label="Notificações">
      <span class="icon-badge">3</span>
      <iconify-icon icon="lucide:bell" width="18" height="18"></iconify-icon>
    </button>
    <button class="icon-button focus-ring" id="userBtn" aria-label="Configurações do usuário" aria-haspopup="true" aria-controls="userDropdown" aria-expanded="false">
      <iconify-icon icon="lucide:settings-2" width="18" height="18"></iconify-icon>
    </button>
    <div class="user-dropdown" id="userDropdown" role="menu" aria-hidden="true">
      <div class="user-info">
        <div class="user-name" id="dropdownUserName">Carregando...</div>
        <div class="user-id" id="dropdownUserId">ID: —</div>
      </div>
      <div style="margin-bottom:12px;display:flex;flex-direction:column;gap:10px;">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
          <div class="plan-pill" id="userPlanPill" aria-hidden="true">Sem Plano</div>
          <div aria-hidden="true" style="font-size:12px;color:var(--muted)">Plano atual</div>
        </div>
        <button id="updatePlanBtn" class="update-plan-btn focus-ring" aria-label="Atualizar plano"> 
          <iconify-icon icon="lucide:chevrons-up" width="18" height="18"></iconify-icon>Atualizar plano
        </button>
        <button id="supportBtn" class="update-plan-btn focus-ring" aria-label="Suporte via WhatsApp" type="button">
          <i class="fa-brands fa-whatsapp whatsapp-fa" aria-hidden="true"></i>Suporte (WhatsApp)
        </button>
      </div>
      <button class="logout-btn focus-ring" id="logoutBtn" aria-label="Sair">
        <iconify-icon icon="lucide:log-out" width="18" height="18"></iconify-icon>Sair
      </button>
    </div>
  </div>
</header>

<main class="main-container">
  <div class="section-header">
    <h1 class="title"><iconify-icon icon="simple-icons:pix" width="28" height="28"></iconify-icon>Pagamento via Pix</h1>
    <p class="subtitle">Seguro, rápido e simples. O código abaixo expira em <strong id="deadlineText">10 minutos</strong>.</p>
  </div>

  <section class="pay-card" aria-labelledby="payTitle">
    <div class="plan-summary">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
        <div style="font-weight:800;color:#0f172a" id="planName">Plano</div>
        <span class="pill" id="planPeriod">—</span>
      </div>
      <div class="kv">
        <div><b>Preço</b><span id="planPrice">—</span></div>
        <div><b>Interceptações/dia</b><span id="planLimit">—</span></div>
      </div>
      <div class="kv">
        <div><b>Suporte</b><span id="planSupport">—</span></div>
        <div><b>Status</b><span id="payStatus">Pendente</span></div>
      </div>
      <div class="kv">
        <div style="grid-column:1/3"><b>ID da transação</b><span id="txId">—</span></div>
      </div>
    </div>
<div class="meta-row">
  <div class="pill"><iconify-icon icon="ph:lightning-bold" width="16" height="16"></iconify-icon>Pix copia e cola • QR Code</div>
  <div class="timer" id="timer" role="status" aria-live="polite" aria-atomic="true"><iconify-icon icon="mdi:timer-outline" width="18" height="18"></iconify-icon><span id="timerText">10:00</span></div>
</div>

<div class="pay-grid">
  <div class="qr-pane">
    <div class="qr-card">
      <img id="qrImage" class="qr-img" alt="QR Code do Pix" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='320' height='320' viewBox='0 0 200 200'><rect width='200' height='200' fill='%23ffffff'/><rect x='10' y='10' width='60' height='60' fill='none' stroke='%23000' stroke-width='10'/><rect x='25' y='25' width='30' height='30' fill='%23000'/><rect x='130' y='10' width='60' height='60' fill='none' stroke='%23000' stroke-width='10'/><rect x='145' y='25' width='30' height='30' fill='%23000'/><rect x='10' y='130' width='60' height='60' fill='none' stroke='%23000' stroke-width='10'/><rect x='25' y='145' width='30' height='30' fill='%23000'/><rect x='90' y='10' width='20' height='20' fill='%23000'/><rect x='90' y='40' width='20' height='20' fill='%23000'/><rect x='90' y='70' width='20' height='20' fill='%23000'/><rect x='120' y='90' width='20' height='20' fill='%23000'/><rect x='60' y='90' width='20' height='20' fill='%23000'/><rect x='40' y='110' width='20' height='20' fill='%23000'/><rect x='90' y='120' width='20' height='20' fill='%23000'/><rect x='120' y='120' width='20' height='20' fill='%23000'/><rect x='150' y='90' width='20' height='20' fill='%23000'/><rect x='150' y='120' width='20' height='20' fill='%23000'/><rect x='120' y='60' width='20' height='20' fill='%23000'/><rect x='60' y='150' width='20' height='20' fill='%23000'/><rect x='90' y='150' width='20' height='20' fill='%23000'/><rect x='120' y='150' width='20' height='20' fill='%23000'/></svg>"/>
    </div>
    <button class="copy-btn focus-ring pulse" id="copyBtn"><iconify-icon icon="lucide:copy" width="18" height="18"></iconify-icon>Copiar código Pix</button>
  </div>

  <div>
    <h2 id="payTitle" class="sr-only">Detalhes do pagamento Pix</h2>
    <div class="field">
      <label class="label" for="pixCode"><span class="inline-icon"><iconify-icon icon="lucide:code" width="16" height="16"></iconify-icon></span>Código Pix (copia e cola)</label>
      <textarea id="pixCode" class="code-input focus-ring" rows="6" readonly spellcheck="false" aria-describedby="copyHelp"></textarea>
      <small id="copyHelp" style="color:var(--muted)">Cole este código no seu banco na opção Pix copia e cola.</small>
    </div>
    <div class="instructions" aria-live="polite">
      <p><span class="inline-icon"><iconify-icon icon="lucide:clipboard-check" width="18" height="18"></iconify-icon></span><span>Copie o código Pix, abra o aplicativo do seu banco, vá na opção Pix copia e cola, cole o código e finalize o pagamento.</span></p>
      <p><span class="inline-icon"><iconify-icon icon="lucide:scan-line" width="18" height="18"></iconify-icon></span><span>Ou, se preferir, escaneie o QR Code ao lado diretamente no aplicativo do seu banco.</span></p>
    </div>
  </div>
</div>

  </section>

<span class="sr-only" id="srStatus" role="status" aria-live="polite"></span>

</main>

<script>
var userBtn=document.getElementById('userBtn'),userDropdown=document.getElementById('userDropdown'),notificationsBtn=document.getElementById('notificationsBtn'),logoutBtn=document.getElementById('logoutBtn'),updatePlanBtn=document.getElementById('updatePlanBtn'),supportBtn=document.getElementById('supportBtn'),srStatus=document.getElementById('srStatus');
function openUserDropdown(){userDropdown.classList.add('show');userDropdown.setAttribute('aria-hidden','false');userBtn.setAttribute('aria-expanded','true')}
function closeUserDropdown(){userDropdown.classList.remove('show');userDropdown.setAttribute('aria-hidden','true');userBtn.setAttribute('aria-expanded','false')}
userBtn.addEventListener('click',function(e){e.stopPropagation();if(userDropdown.classList.contains('show')){closeUserDropdown()}else{openUserDropdown()}});
document.addEventListener('click',function(e){if(!e.target.closest('.user-dropdown')&&!e.target.closest('#userBtn')){closeUserDropdown()}});
document.addEventListener('keydown',function(e){if(e.key==='Escape'){closeUserDropdown()}});
notificationsBtn.addEventListener('click',function(){window.location.href='/notifications'});
logoutBtn.addEventListener('click',function(){window.location.href='/logout'});
updatePlanBtn&&updatePlanBtn.addEventListener('click',function(){window.location.href='/plans'});
supportBtn&&supportBtn.addEventListener('click',function(){window.open('https://wa.me/5511941153647','_blank')});
function announce(m){srStatus.textContent=m;setTimeout(function(){srStatus.textContent=''},3000)}
function qs(k){var u=new URLSearchParams(location.search);return u.get(k)}
function anyTid(){return qs('tid')||qs('tx')||qs('id')||qs('txid')}
function toast(msg){var t=document.createElement('div');t.className='toast';t.textContent=msg;document.body.appendChild(t);requestAnimationFrame(function(){t.classList.add('show')});setTimeout(function(){t.classList.remove('show');setTimeout(function(){t.remove()},200)},2200)}
var timerEl=document.getElementById('timer'),timerText=document.getElementById('timerText');var copyBtn=document.getElementById('copyBtn');var pixCodeEl=document.getElementById('pixCode');var qrImage=document.getElementById('qrImage');var planName=document.getElementById('planName');var planPrice=document.getElementById('planPrice');var planPeriod=document.getElementById('planPeriod');var planLimit=document.getElementById('planLimit');var planSupport=document.getElementById('planSupport');var payStatusEl=document.getElementById('payStatus');var deadlineText=document.getElementById('deadlineText');var txIdEl=document.getElementById('txId');var PIX_PAYLOAD='';var TID=anyTid();var remaining=600;var expired=false;
function fmt(s){var m=String(Math.floor(s/60)).padStart(2,'0');var ss=String(s%60).padStart(2,'0');return m+':'+ss}
async function getInfo(){var u=TID?('/api/pay/info?tid='+encodeURIComponent(TID)):'/api/pay/info';try{var r=await fetch(u,{credentials:'include'});if(!r.ok){var payload=qs('payload');var qr=qs('qr');if(payload){PIX_PAYLOAD=payload;pixCodeEl.value=PIX_PAYLOAD}if(qr){qrImage.setAttribute('src',qr)}if(TID){txIdEl.textContent=TID}return}var data=await r.json();if(!data||data.ok===false){if(TID){txIdEl.textContent=TID}return}if(data.plan){planName.textContent=data.plan.name||'Plano';planPrice.textContent=data.plan.price_display||'—';planPeriod.textContent=data.plan.period||'—';planLimit.textContent=(data.plan.limit_per_day||'—');planSupport.textContent=data.plan.support||'WhatsApp'}if(data.deadline_seconds!=null){remaining=Math.max(0,parseInt(data.deadline_seconds,10));deadlineText.textContent=(Math.floor(remaining/60)||0)+' minutos'}if(data.status){payStatusEl.textContent=(String(data.status).toLowerCase()==='paid'?'Pago':'Pendente')}if(data.transaction_id){txIdEl.textContent=data.transaction_id}else if(TID){txIdEl.textContent=TID}if(data.pix_payload){PIX_PAYLOAD=data.pix_payload;pixCodeEl.value=PIX_PAYLOAD}if(data.qr_png_base64){qrImage.setAttribute('src','data:image/png;base64,'+data.qr_png_base64)}else if(data.qr_url){qrImage.setAttribute('src',data.qr_url)}else if(TID){fetch('/api/pix/qr/'+encodeURIComponent(TID),{credentials:'include'}).then(function(r){if(r.ok)return r.blob()}).then(function(b){if(b){var o=URL.createObjectURL(b);qrImage.setAttribute('src',o)}}).catch(function(){})}}catch(e){}}
async function poll(){if(expired)return;var u=TID?('/api/pay/status?tid='+encodeURIComponent(TID)):(null);if(!u&&qs('txid')){u='/check/'+encodeURIComponent(qs('txid'))}if(!u&&TID){u='/check/'+encodeURIComponent(TID)}if(!u)return;try{var r=await fetch(u,{credentials:'include'});if(!r.ok)return;var j=await r.json();var st=j.status||j.state||j.payment_status;var s=st?String(st).toLowerCase():null;if(s==='paid'||s==='pago'||s==='success'||s==='confirmed'){payStatusEl.textContent='Pago';toast('Pagamento identificado');setTimeout(function(){location.href='/dashboard'},900)}}catch(e){}}
function tick(){if(remaining<=0){if(!expired){expired=true;timerText.textContent='00:00';timerEl.classList.add('expired');copyBtn.setAttribute('disabled','true');announce('O código Pix expirou. Gere um novo pedido se necessário.')}}else{remaining-=1;timerText.textContent=fmt(remaining)}}
copyBtn.addEventListener('click',async function(){try{if(!PIX_PAYLOAD||copyBtn.disabled)return;if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(PIX_PAYLOAD)}else{pixCodeEl.focus();pixCodeEl.select();document.execCommand('copy');window.getSelection().removeAllRanges()}announce('Código Pix copiado com sucesso.')}catch(e){announce('Não foi possível copiar automaticamente. Selecione e copie manualmente.')}});
function qsVal(k){var u=new URLSearchParams(location.search);return u.get(k)}
function populateUserInfo(){var nameEl=document.getElementById('dropdownUserName'),idEl=document.getElementById('dropdownUserId'),planEl=document.getElementById('userPlanPill');fetch('/api/me',{credentials:'include'}).then(function(r){if(!r.ok){nameEl.textContent='Convidado';idEl.textContent='ID: —';planEl.textContent='Sem Plano';planEl.classList.add('inactive');return {}}return r.json()}).then(function(data){if(data&&data.ok&&data.user){var u=data.user;nameEl.textContent=u.username||'Usuário';idEl.textContent='ID: '+(u.id||'—');var plan=(data.plan&&data.plan.name)||'';if(plan&&plan!=='Sem Plano'){planEl.textContent=plan;planEl.classList.remove('inactive')}else{planEl.textContent='Sem Plano';planEl.classList.add('inactive')}}else{nameEl.textContent='Convidado';idEl.textContent='ID: —';planEl.textContent='Sem Plano';planEl.classList.add('inactive')}}).catch(function(){var nameEl=document.getElementById('dropdownUserName'),idEl=document.getElementById('dropdownUserId'),planEl=document.getElementById('userPlanPill');nameEl.textContent='Convidado';idEl.textContent='ID: —';planEl.textContent='Sem Plano';planEl.classList.add('inactive')})
}
document.addEventListener('DOMContentLoaded',function(){populateUserInfo();getInfo().then(function(){timerText.textContent=fmt(remaining)});setInterval(tick,1000);setInterval(poll,3000)})
</script>

</body>
</html>
